{% extends "base.html" %}
{% block content %}

<style>
/* =====================
   ORDER CONFIRMATION
   ===================== */

.order-confirm {
    max-width: 420px;
    margin: 40px auto;
    background: #ffffff;
    padding: 30px 22px;
    border-radius: 22px;
    box-shadow: 0 18px 45px rgba(0,0,0,0.14);
    text-align: center;
    animation: fadeUp 0.6s ease-out;
}

@keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to   { opacity: 1; transform: translateY(0); }
}

/* Animated Check */

.check-circle {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    background: #10b981;
    margin: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: pop 0.5s ease-out;
}

@keyframes pop {
    0%   { transform: scale(0); }
    80%  { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.check {
    font-size: 42px;
    color: white;
    font-weight: bold;
}

/* Text */

.order-confirm h2 {
    margin-top: 16px;
    font-size: 22px;
    font-weight: 800;
    color: #065f46;
}

.order-confirm p {
    font-size: 14px;
    color: #374151;
    margin-top: 8px;
    line-height: 1.5;
}

/* Countdown box */

.delivery-time {
    margin-top: 16px;
    background: #ecfdf5;
    color: #065f46;
    padding: 12px;
    border-radius: 14px;
    font-size: 15px;
    font-weight: 700;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0%   { box-shadow: 0 0 0 0 rgba(16,185,129,0.4); }
    70%  { box-shadow: 0 0 0 10px rgba(16,185,129,0); }
    100% { box-shadow: 0 0 0 0 rgba(16,185,129,0); }
}

.redirect-text {
    margin-top: 14px;
    font-size: 12px;
    color: #6b7280;
}
</style>

<div class="order-confirm">

    <div class="check-circle">
        <div class="check">âœ“</div>
    </div>

    <h2>Order Confirmed!</h2>

    {% if order %}
        <p>
            Thank you <strong>{{ order.customer_name }}</strong> ðŸ˜Š  
            Your order has been received successfully.
        </p>

        <!-- LIVE COUNTDOWN -->
        <div class="delivery-time">
            ðŸšš Your order will reach in  
            <strong><span id="countdown">30:00</span></strong>
        </div>

        <div class="redirect-text">
            Redirecting you shortlyâ€¦
        </div>
    {% else %}
        <p>Something went wrong. Please contact support.</p>
    {% endif %}

</div>

<!-- =====================
     COUNTDOWN + WHATSAPP + REDIRECT
     ===================== -->
<script>
/* -------- 30 MIN COUNTDOWN -------- */
let time = 30 * 60; // seconds
const countdownEl = document.getElementById("countdown");

const timer = setInterval(() => {
    let minutes = Math.floor(time / 60);
    let seconds = time % 60;

    if (countdownEl) {
        countdownEl.innerText =
            `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
    }

    time--;

    if (time < 0) {
        clearInterval(timer);
        if (countdownEl) countdownEl.innerText = "Arriving now ðŸš´";
    }
}, 1000);

/* -------- AUTO WHATSAPP SEND -------- */
setTimeout(function () {
    window.open("{{ whatsapp_url }}", "_blank");
}, 1500);

/* -------- AUTO REDIRECT -------- */
setTimeout(function () {
    {% if session.get('is_admin') %}
        window.location.href = "{{ url_for('admin_orders') }}";
    {% else %}
        window.location.href = "{{ url_for('menu') }}";
    {% endif %}
}, 4000);
</script>

{% endblock %}
